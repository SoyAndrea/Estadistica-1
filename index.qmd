---
title: "Estadística 1"
author: "Andrea Gomez Vargas"
toc: true
number-sections: true
#highlight-style: pygments
language: 
  title-block-author-single: "Estudiante"
format:
   html: 
    theme: flatly
    code-fold: true
    html-math-method: katex
    df-print: kable
   pdf:
    geometry: 
      - top=30mm
      - left=30mm
   docx: default
---

# Primera parte: Evaluación conceptual y teórica

```{r}
#| echo: true
#| warning: false
#| include: false

library(gt)
library(gtExtras)
library(kableExtra)
library(tidyverse)
```

## Consigne las definiciones de Población, muestra y unidad de análisis

-   **Población:** es un conjunto de *todos* los elementos que estamos estudiando, acerca de los cuales intentamos sacar conclusiones. Debemos definir esa población de modo que quede claro cuándo cierto elemento pertenece o no a la población.[^1]

-   **Muestra:** Colección de algunos elementos —no todos—, de la población bajo estudio, utilizada para describir poblaciones.

    -   Muestra representativa: Muestra que contiene las características importantes de la población en las mismas proporciones en que están contenidas en la población.

-   **Unidad de Análisis:** o la unidad de estudio u objeto/sujeto de estudio (los elementos que van a ser estudiados), mientras que la unidad de recolección es la fuente proveedora de la información requerida, son los elementos que funcionan como informantes

[^1]: [Levin, Richard I. y Rubin, David S. Estadística para Administración y Economía, México, 2004](https://drive.google.com/file/d/1WLEdjR0WAI9UFv178iBQv4nhLVa8V_DX/view)

## Consigne, defina y ejemplifique los niveles de medición de Stevens

```{r}
#| echo: false
tabla_1 <- openxlsx::read.xlsx("tablas.xlsx", sheet = "1") 


gt(tabla_1) %>%
  tab_header(
    title = md("**Tabla 1: niveles de medición**")) %>%
  tab_options(
    heading.align = "left",
    row_group.font.weight = "bolder",
    heading.background.color = "#9a8c98") %>%
  cols_label(
    nivel_medicion = "Nivel", definicion = "Definición", ejemplo =  "Ejemplo"
  ) %>%
   tab_style(
    style = list(cell_text(weight = "bold")),
    locations = cells_body(
      columns = nivel_medicion))
```

## Consigne las principales propiedades de la distribución normal

La distribución normal, también conocida como **distribución gaussiana o curva de campana**, es una de las distribuciones de probabilidad más importantes en estadística.

::: {layout="[0.4, 0.6]"}
::: {#firstcol}
<br> $${X \sim  N(\mu,\sigma)}$$

donde:

-   ($X$) es la variable aleatoria
-   ($\mu$) es la media (promedio) de la distribución.
-   ($\sigma$) es la desviación estándar, que mide la dispersión de los datos.
:::

::: {#secondcol}
```{r}
#| echo: false

# Media y desviación típica
mu <- 25
sigma <- 5

# Grid para una distribución normal no estándar
x <- seq(-3, 3, length = 100) * sigma + mu

# Función de densidad
f <- dnorm(x, mu, sigma)

plot(x, f, type = "l", lwd = 2, col = "blue", ylab = "", xlab = "X")
abline(v = mu) # Línea vertical en la media

```
:::
:::

Esta distribución tiene las siguientes características clave:

-   Simetría: Es simétrica alrededor de la media ($\mu$), lo que significa que las colas izquierda y derecha de la distribución son idénticas.

-   Unimodal: Tiene un solo pico en la media ($\mu$) (punto por el que pasa el eje de simetría).

-   Forma de Campana: La función de densidad de probabilidad forma una curva en forma de campana.

-   Regla Empírica: Aproximadamente el 68% de los datos caen dentro de una desviación estándar de la media, el 95% dentro de dos desviaciones estándar y el 99.7% dentro de tres desviaciones estándar.

-   El área bajo la curva es igual a 1

-   La desviación estándar ($\sigma$) es la distancia entre el eje de simetría y el punto donde cambia la curvatura.

## Concepto y elementos constitutivos de las pruebas de hipótesis

# Segunda parte: Evaluación práctica

Se ha realizado una encuesta a jóvenes españoles en el año 2000. Se muestran a continuación las 16 preguntas que contenía el cuestionario.

## Para cada una de las preguntas definir:

```         
a.  Las variables que contienen información a analizar estadísticamente.

b.  Identificar, para cada una de ellas el nivel de medición y las modalidades/categorías que la integran.
```

```{r}
#| echo: false
tabla_2 <- openxlsx::read.xlsx("tablas.xlsx", sheet = "2") %>% 
  group_by(eje) %>% select(-1) %>% 
gt() %>% 
  tab_header(
    title = md("**Tabla 2: variables cuestionario**")) %>% 
   # gt_merge_stack(
   #          col1 = variables,
   #          col2 = nivel
   #          #col2 = categorias
   #          ) %>%
  cols_label(
    pregunta = "Pregunta", variables = "Variables", categorias =  "Categorías",
    nivel = "Nivel de medición"
  ) %>% 
   tab_options(
    heading.align = "left",
    row_group.font.weight = "bolder",
    heading.background.color = "#9a8c98")

tabla_2
```

# Tercera parte: Análisis estadístico descriptivo

En esta actividad se trabajará con el archivo de datos “cuestionario.xlsx”.

## Importar los datos a R.

```{r}
cuestionario <- openxlsx::read.xlsx("EVALUACION/cuestionario.xlsx")
```

## Utilizando la función table() y sus funciones anexas, calcular

### Las tablas de frecuencias absolutas para las variables ocio, genero, colegio, amor, religión

#### Ocio

```{r}
addmargins(table(cuestionario$ocio,useNA = "always")) %>% kbl()
```

#### Género

```{r}
addmargins(table(cuestionario$genero,useNA = "always")) %>% kbl()
```

#### Colegio

```{r}
addmargins(table(cuestionario$colegio,useNA = "always")) %>% kbl()
```

#### Amor

```{r}
addmargins(table(cuestionario$amor,useNA = "always")) %>% kbl()
```

#### Religión

```{r}
addmargins(table(cuestionario$religion,useNA = "always")) %>% kbl()
```

### Las tablas de frecuencias relativas para las variables ocio, genero, colegio, amor, religión

#### Ocio

```{r}
kbl(round(prop.table(table(cuestionario$ocio))*100,2))
```

#### género

```{r}
kbl(round(prop.table(table(cuestionario$genero))*100,2))
```

#### colegio

```{r}
kbl(round(prop.table(table(cuestionario$colegio))*100,2))
```

#### amor

```{r}
kbl(round(prop.table(table(cuestionario$amor))*100,2))
```

#### religión

```{r}
kbl(round(prop.table(table(cuestionario$religion))*100,2))
```

## Realizar gráficos de barras para cada una de las variables anteriores

```         
a.  Con la frecuencia relativa
b.  Con la frecuencia porcentual
```

### Gráfico 1: frecuencia absoluta y porcentual por variable género

```{r}

par(mfrow = c(1, 2))

g1 <- barplot(table(cuestionario$genero),
        main="frecuencia absoluta por género",
        xlab="género",
        ylab="frecuencia absoluta",
        border="#386641",
        col="#386641",
        density=100,
        ylim= c(0, 400))

text(x = g1, 
     y = table(cuestionario$genero), 
     label = table(cuestionario$genero), 
     pos = 3, 
     cex = 0.8, 
     col = "black")


p1 <- round(prop.table(table(cuestionario$genero))*100,2)

g2 <- barplot(p1,
        main="frecuencia porcentual por género",
        xlab="género",
        ylab="frecuencia porcentual",
        border="#003554",
        col="#003554",
        density=80,
ylim =  c(0,60))

text(x = g2, 
     y = p1,
     label = p1,
     pos = 3, 
     cex = 0.8, 
     col = "black")



```

### Gráfico 2: frecuencia absoluta y porcentual por variable ocio

```{r}

par(mfrow = c(1, 2))

g3 <- barplot(table(cuestionario$ocio),
        main="frecuencia absoluta por ocio",
        xlab="ocio",
        ylab="frecuencia absoluta",
        border="#386641",
        col="#386641",
        density=100,
        ylim =  c(0,250))


text(x = g3, 
     y = table(cuestionario$ocio), 
     label = table(cuestionario$ocio), 
     pos = 3, 
     cex = 0.8, 
     col = "black")


p2 <- round(prop.table(table(cuestionario$ocio))*100,2)

g4 <- barplot(p2,
        main="frecuencia porcentual por ocio",
        xlab="ocio",
        ylab="frecuencia porcentual",
        border="#003554",
        col="#003554",
        density=80, 
        ylim =  c(0,35))

text(x = g4, 
     y = p2, 
     label = p2, 
     pos = 3, 
     cex = 0.8, 
     col = "black")


```

### Gráfico 3: frecuencia absoluta y porcentual por variable amor

```{r}

par(mfrow = c(1, 2))

g5 <- barplot(table(cuestionario$amor),
        main="frecuencia absoluta por amor",
        xlab="amor",
        ylab="frecuencia absoluta",
        border="#386641",
        col="#386641",
        density=100,
        ylim=c(0, 350))

text(x = g5, 
     y = table(cuestionario$amor), 
     label = table(cuestionario$amor), 
     pos = 3, 
     cex = 0.8, 
     col = "black")


p3 <- round(prop.table(table(cuestionario$amor))*100,2)

g6 <- barplot(p3,
        main="frecuencia porcentual por amor",
        xlab="amor",
        ylab="frecuencia porcentual",
        border="#003554",
        col="#003554",
        density=80, 
        ylim=c(0, 50))

text(x = g6, 
     y = p3, 
     label = p3, 
     pos = 3, 
     cex = 0.8, 
     col = "black")

```

### Gráfico 4: frecuencia absoluta y porcentual por variable colegio

```{r}

par(mfrow = c(1, 2))

g7 <- barplot(table(cuestionario$colegio),
        main="frecuencia absoluta por colegio",
        xlab="colegio",
        ylab="frecuencia absoluta",
        border="#386641",
        col="#386641",
        density=100,
        ylim =  c(0,600))

text(x = g7, 
     y = table(cuestionario$colegio), 
     label = table(cuestionario$colegio), 
     pos = 3, 
     cex = 0.8, 
     col = "black")


p4 <- round(prop.table(table(cuestionario$colegio))*100,2)

g8 <- barplot(p4,
        main="frecuencia porcentual por colegio",
        xlab="colegio",
        ylab="frecuencia porcentual",
        border="#003554",
        col="#003554",
        density=80,
        ylim =  c(0,80))

text(x = g8, 
     y = p4, 
     label = p4, 
     pos = 3, 
     cex = 0.8, 
     col = "black")



```

### Gráfico 5: frecuencia absoluta y porcentual por variable religión

```{r}

par(mfrow = c(1, 2))

g9 <- barplot(table(cuestionario$religion),
        main="frecuencia absoluta por religion",
        xlab="religion",
        ylab="frecuencia absoluta",
        border="#386641",
        col="#386641",
        density=100,
ylim = c(0,350))

text(x = g9, 
     y = table(cuestionario$religion), 
     label = table(cuestionario$religion), 
     pos = 3, 
     cex = 0.8, 
     col = "black")


p5 <- round(prop.table(table(cuestionario$religion))*100,2)

g10 <- barplot(p5,
        main="frecuencia porcentual por religion",
        xlab="religion",
        ylab="frecuencia porcentual",
        border="#003554",
        col="#003554",
        density=80,
ylim = c(0,50))

text(x = g10, 
     y = p5, 
     label = p5, 
     pos = 3, 
     cex = 0.8, 
     col = "black")




```

## Calcular las tablas de contingencia para los siguientes cruces de variables

### Ocio y genero

::: {layout="[0.5, 0.5]"}
<div>

```{r}
# absoluta
addmargins(table(cuestionario$ocio, cuestionario$genero,useNA = "always")) %>% kbl()
```

</div>

<div>

```{r}
# relativa
kbl(round(prop.table(table(cuestionario$ocio, cuestionario$genero))*100,2))

```

</div>
:::

### Ocio y colegio

::: {layout="[0.5, 0.5]"}
<div>

```{r}
# absoluta
addmargins(table(cuestionario$ocio, cuestionario$colegio,useNA = "always")) %>% kbl()
```

</div>

<div>

```{r}
# relativa
kbl(round(prop.table(table(cuestionario$ocio, cuestionario$colegio))*100,2))

```

</div>
:::

### Amor y religión

```{r}
# absoluta
addmargins(table(cuestionario$amor, cuestionario$religion,useNA = "always")) %>% kbl()

# relativa
kbl(round(prop.table(table(cuestionario$amor, cuestionario$religion))*100,2))

```

### Colegio y religión

```{r}
# absoluta
addmargins(table(cuestionario$colegio, cuestionario$religion,useNA = "always")) %>% kbl()

# relativa
kbl(round(prop.table(table(cuestionario$colegio, cuestionario$religion))*100,2))

```

# Cuarta parte: Contrastes de hipótesis

Utilizando los datos del archivo cuestionario y técnicas paramétricss y no paramétricas,

a)  Determinar con un nivel de significación del 5% si el promedio de horas libres a la semana para ocio o diversión en los hombres es mayor a la de las mujeres. Concluir en términos del problema

b)  Determinar si hay diferencias en la cantidad promedio de libros leídos si tenemos en cuenta la asistencia de los jóvenes a colegio estatal o privado. Utilizar un nivel de significación del 5%. Concluir en términos del problema

c)  Determinar en cada caso, cuál es el test más adecuado. Justificar.
